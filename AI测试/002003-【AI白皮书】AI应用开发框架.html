

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>【AI白皮书】AI应用开发框架 &mdash; 测试开发Gang latest documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/readmore.js"></script>
        <script src="../_static/js/baidutongji.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="【AI白皮书】上下文工程" href="002004-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91%E4%B8%8A%E4%B8%8B%E6%96%87%E5%B7%A5%E7%A8%8B.html" />
    <link rel="prev" title="【AI白皮书】AI原生应用的关键要素" href="002002-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E7%9A%84%E5%85%B3%E9%94%AE%E8%A6%81%E7%B4%A0.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> 测试开发Gang
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../%E5%85%B3%E4%BA%8E%E6%9C%AC%E4%B9%A6.html">关于本书</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../chapters/AI%E6%B5%8B%E8%AF%95.html">AI测试</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="001001-AI%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91%E6%96%B0%E5%A7%BF%E5%8A%BFMCP%20Python%20SDK.html">AI测试工具开发新姿势MCP Python SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="002001-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E5%8F%8A%E5%85%B6%E6%9E%B6%E6%9E%84.html">【AI白皮书】AI原生应用及其架构</a></li>
<li class="toctree-l2"><a class="reference internal" href="002002-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E7%9A%84%E5%85%B3%E9%94%AE%E8%A6%81%E7%B4%A0.html">【AI白皮书】AI原生应用的关键要素</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">【AI白皮书】AI应用开发框架</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">3.1 智能体的定义与主流开发范式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">3.1.1 什么是智能体</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">3.1.2 智能体的主流开发范式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">3.1.3 单智能体</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">3.1.4 工作流</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">3.1.5 多智能体系统</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id7">3.2 开发一个简单的智能体</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">3.2.1 智能体框架选型</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spring-ai-alibabaagent">3.2.2 Spring AI Alibaba中的Agent定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#agentic-api">3.2.3 示例代码与Agentic API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id9">3.3 工作流与多智能体</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spring-ai-alibab">3.3.1 Spring AI Alibab中的多智能体类型</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sequentialagent">3.3.2 工作流 - SequentialAgent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parallelagent">3.3.3 工作流 - ParallelAgent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loopagent">3.3.4 工作流 - LoopAgent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#llmroutingagent">3.3.5 多智能体系统 - LlmRoutingAgent</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">3.4 从单进程到分布式部署</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a2a">3.4.1 什么是A2A协议</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">3.4.2 A2A协议的工作流</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nacos-a2a-registry">3.4.3 基于Nacos A2A Registry的自动注册与发现</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nacos-a2a">3.4.4 Nacos A2A注册中心</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">3.5 消息驱动的智能体开发模式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ai">3.5.1 消息模型提升AI通信效率</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">3.5.2 基于消息驱动的智能化资源调度</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id14">3.6 基于统一元数据的AI协同开发模式</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="002004-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91%E4%B8%8A%E4%B8%8B%E6%96%87%E5%B7%A5%E7%A8%8B.html">【AI白皮书】上下文工程</a></li>
<li class="toctree-l2"><a class="reference internal" href="002005-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E5%B7%A5%E5%85%B7.html">【AI白皮书】AI工具</a></li>
<li class="toctree-l2"><a class="reference internal" href="002006-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E7%BD%91%E5%85%B3.html">【AI白皮书】AI网关</a></li>
<li class="toctree-l2"><a class="reference internal" href="002007-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E5%BA%94%E7%94%A8%E8%BF%90%E8%A1%8C%E6%97%B6.html">【AI白皮书】AI应用运行时</a></li>
<li class="toctree-l2"><a class="reference internal" href="002008-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E5%8F%AF%E8%A7%82%E6%B5%8B.html">【AI白皮书】AI可观测</a></li>
<li class="toctree-l2"><a class="reference internal" href="002009-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E8%AF%84%E4%BC%B0.html">【AI白皮书】AI评估</a></li>
<li class="toctree-l2"><a class="reference internal" href="002010-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E5%AE%89%E5%85%A8.html">【AI白皮书】AI安全</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/pytest.html">pytest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Django.html">Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Flask.html">Flask</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/FastAPI.html">FastAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/HttpRunner.html">HttpRunner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E5%8E%9F%E5%88%9B%E5%B0%8F%E5%B7%A5%E5%85%B7.html">原创小工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E5%8E%9F%E5%88%9B%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6tep.html">原创接口测试框架tep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E5%8E%9F%E5%88%9B%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0teprunner.html">原创接口测试平台teprunner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A.html">测试报告</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E8%87%AA%E5%8A%A8%E5%8C%96.html">自动化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83.html">测试环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%B5%81%E9%87%8F%E5%9B%9E%E6%94%BE.html">流量回放</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html">性能测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%A7%BB%E5%8A%A8%E7%AB%AF.html">移动端</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9F%A5%E8%AF%86.html">计算机知识</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E4%B8%AD%E9%97%B4%E4%BB%B6.html">中间件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%AE%97%E6%B3%95.html">算法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Java.html">Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95.html">单元测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/JavaWeb%E5%BC%80%E5%8F%91.html">JavaWeb开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Spring%E6%8A%80%E6%9C%AF%E6%A0%88.html">Spring技术栈</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html">设计模式</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E7%99%BD%E7%9B%92%E6%B5%8B%E8%AF%95.html">白盒测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/TestNG.html">TestNG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/Golang.html">Golang</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html">读书笔记</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapters/%E4%B8%AA%E4%BA%BA%E6%80%9D%E8%80%83.html">个人思考</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E5%B0%8A%E4%BA%AB%E6%9C%8D%E5%8A%A1.html">尊享服务</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">测试开发Gang</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../chapters/AI%E6%B5%8B%E8%AF%95.html">AI测试</a> &raquo;</li>
        
      <li>【AI白皮书】AI应用开发框架</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/AI测试/002003-【AI白皮书】AI应用开发框架.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aiai">
<h1>【AI白皮书】AI应用开发框架<a class="headerlink" href="#aiai" title="Permalink to this headline">¶</a></h1>
<p><img alt="image1" src="../_images/wanggang.png" /></p>
<div class="section" id="id1">
<h2>3.1 智能体的定义与主流开发范式<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>3.1.1 什么是智能体<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>智能体（Agent）可以理解为一个具备自主理解、规划、记忆和工具使用能力的数字化实体。</p>
<p>我们在前面了解到LLM、MCP，它们和Agent是啥关系呢？LLM是“大脑”，Agent是“身体”，Agent通过MCP协议访问外部能力（Tools
/ Resources）。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>【纯LLM交互】
用户：帮我分析main.py文件
LLM：我无法直接访问文件，请您将文件内容粘贴给我


【Agent交互】
用户：帮我分析main.py文件
Agent：我来读取并分析这个文件
      → 调用文件读取工具
      → 分析代码结构
      → 提供详细分析报告
</pre></div>
</div>
<p>智能体让AI从一个只会内容生成的语言模型，进化成一个具备自主规划能力的行动者。</p>
</div>
<div class="section" id="id3">
<h3>3.1.2 智能体的主流开发范式<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>简单LLM应用：直接调用模型API实现内容生成</p></li>
<li><p>单智能体：增加RAG、Tool、Memory等，让模型具备与特定环境交互的能力</p></li>
<li><p>工作流：将应用拆分，形成多个独立子智能体，再按照预定义的流程编排起来</p></li>
<li><p>多智能体系统：相比于工作流，多智能体系统采用的是模型驱动的、对话式的流程编排，各个子智能体具备更多的自主决策权</p></li>
</ul>
</div>
<div class="section" id="id4">
<h3>3.1.3 单智能体<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>典型的单智能体架构如下：</p>
<p><img alt="image2" src="../_images/2025-11-17-20-01-32-image.png" /></p>
<p>单智能体非常依赖底层模型能力。</p>
</div>
<div class="section" id="id5">
<h3>3.1.4 工作流<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p><strong>1、Chain - 链式工作流</strong></p>
<p><img alt="image3" src="../_images/2025-11-18-11-22-35-image.png" /></p>
<p>每一步由一个独立的LLM调用完成，并将上一阶段的输出作为下一阶段的输入。</p>
<p><strong>2、Routing - 路由工作流</strong></p>
<p><img alt="image4" src="../_images/2025-11-18-11-23-42-image.png" /></p>
<p>对输入进行分类，将它们分派到专门设计的下游任务或处理路径。</p>
</div>
<div class="section" id="id6">
<h3>3.1.5 多智能体系统<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p><img alt="image5" src="../_images/2025-11-18-11-27-24-image.png" /></p>
<p>由多个具备一定自治能力的Agent组成，每个Agent有自己的角色、能力或工具使用范围。它们之间可以通过消息或上下文进行交互，协同完成复杂目标。</p>
</div>
</div>
<div class="section" id="id7">
<h2>3.2 开发一个简单的智能体<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id8">
<h3>3.2.1 智能体框架选型<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>Python：LangChain、LlamaIndex、AutoGen、CrewAI，开源的Google
ADK、Strands等，阿里云开源的AgentScope等</p>
<p>Java：Spring AI Alibaba等</p>
<p>这本白皮书是阿里出的，后面就用Spring AI Alibaba为例进行介绍。</p>
</div>
<div class="section" id="spring-ai-alibabaagent">
<h3>3.2.2 Spring AI Alibaba中的Agent定义<a class="headerlink" href="#spring-ai-alibabaagent" title="Permalink to this headline">¶</a></h3>
<p>React
Agent，采用ReAct模式，将推理（Reasoning）和行动（Action）交错进行，形成一个动态的“思考-行动-观察”循环。</p>
<p><img alt="image6" src="../_images/2025-11-18-15-24-28-image.png" /></p>
<p><strong>思考（Thought）</strong>：LLM分析当前的任务目标、已有的信息和可用的工具，然后生成一个关于下一步应该做什么的推理过程或计划。这个思路过程通常会以自然语言文本展示，解释了它的决策逻辑。</p>
<p><strong>行动（Action）</strong>：智能体决定调用的外部工具（如搜索引擎、数据库查询API或自定义函数）。它会生成结构化的指令，明确指出要调用的工具名称和所需的参数。</p>
<p><strong>观察（Observation）</strong>：应用程序执行工具调用，并将返回的结果（如搜索结果、API响应或函数返回值）作为观察信息反馈给智能体。</p>
<p><strong>循环迭代</strong>：智能体收到观察结果，和之前的“思考”、任务目标结合，进入新一轮的思考阶段。它会评估上一步行动的结果是否使其更接近最终目标，并据此规划下一步的行动。</p>
</div>
<div class="section" id="agentic-api">
<h3>3.2.3 示例代码与Agentic API<a class="headerlink" href="#agentic-api" title="Permalink to this headline">¶</a></h3>
<p><strong>1、快速定义一个简单的Agent</strong></p>
<p><img alt="image7" src="../_images/2025-11-18-15-45-59-image.png" /></p>
<p><strong>2、引导Agent的行为（设置Prompt提示词）</strong></p>
<p><img alt="image8" src="../_images/2025-11-18-16-03-06-image.png" /></p>
<p>instruction包括以下信息：</p>
<ul class="simple">
<li><p>核心任务或目标</p></li>
<li><p>性格或角色</p></li>
<li><p>行为约束</p></li>
<li><p>如何及何时使用工具</p></li>
<li><p>期望的输出格式</p></li>
</ul>
<p>第四章上下文工程将介绍更多instruction编写技巧。</p>
<p><strong>3、更多高级设置：为Agent配置工具、模型参数等</strong></p>
<p><img alt="image9" src="../_images/2025-11-18-16-07-24-image.png" /></p>
<p>LLM会根据当前的对话内容和自身的指令，利用工具的函数/工具名称、描述（来自文档字符串或description字段）以及参数结构（Schemas）来决定调用哪一个工具。</p>
</div>
</div>
<div class="section" id="id9">
<h2>3.3 工作流与多智能体<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spring-ai-alibab">
<h3>3.3.1 Spring AI Alibab中的多智能体类型<a class="headerlink" href="#spring-ai-alibab" title="Permalink to this headline">¶</a></h3>
<p><img alt="image10" src="../_images/2025-11-18-17-31-16-image.png" /></p>
<p><img alt="image11" src="../_images/2025-11-18-17-31-36-image.png" /></p>
<p>总体上分为三种Agent类型：</p>
<p><strong>ReactAgent</strong>：基本智能体</p>
<p><strong>FlowAgent</strong>：包含多个ReactAgent，按照特定流程协作</p>
<ul class="simple">
<li><p>SequentialAgent 串行</p></li>
<li><p>ParallelAgent 并行</p></li>
<li><p>LoopAgent 循环</p></li>
<li><p>LlmRoutingAgent 大模型决策</p></li>
</ul>
<p><strong>A2ARemoteAgent</strong>：分布式Agent</p>
</div>
<div class="section" id="sequentialagent">
<h3>3.3.2 工作流 - SequentialAgent<a class="headerlink" href="#sequentialagent" title="Permalink to this headline">¶</a></h3>
<p><img alt="image12" src="../_images/2025-11-18-20-10-44-image.png" /></p>
<p>Agent依次执行，上一个Agent的输出会作为下一个Agent的输入。</p>
<p>示例，开发一个文章协作助手的智能体：</p>
<p><img alt="image13" src="../_images/2025-11-18-20-11-58-image.png" /></p>
<p><img alt="image14" src="../_images/2025-11-18-20-12-27-image.png" /></p>
<p>先定义了2个ReactAgent，然后定义了1个SequentialAgent将它们串联起来。</p>
</div>
<div class="section" id="parallelagent">
<h3>3.3.3 工作流 - ParallelAgent<a class="headerlink" href="#parallelagent" title="Permalink to this headline">¶</a></h3>
<p><img alt="image15" src="../_images/2025-11-18-20-15-18-image.png" /></p>
<p>并行执行的工作流模式。</p>
<p>示例，开发一个智能搜索助手的智能体：</p>
<p><img alt="image16" src="../_images/2025-11-18-20-16-25-image.png" /></p>
<p><img alt="image17" src="../_images/2025-11-18-20-16-44-image.png" /></p>
<p><img alt="image18" src="../_images/2025-11-18-20-17-03-image.png" /></p>
<p><img alt="image19" src="../_images/2025-11-18-20-17-23-image.png" /></p>
</div>
<div class="section" id="loopagent">
<h3>3.3.4 工作流 - LoopAgent<a class="headerlink" href="#loopagent" title="Permalink to this headline">¶</a></h3>
<p><img alt="image20" src="../_images/2025-11-18-20-18-31-image.png" /></p>
<p>在指定的迭代次数内重复运行一系列代理，或者直到满足终止条件。</p>
<p><img alt="image21" src="../_images/2025-11-18-20-19-40-image.png" /></p>
</div>
<div class="section" id="llmroutingagent">
<h3>3.3.5 多智能体系统 - LlmRoutingAgent<a class="headerlink" href="#llmroutingagent" title="Permalink to this headline">¶</a></h3>
<p><img alt="image22" src="../_images/2025-11-19-00-00-14-image.png" /></p>
<p>通过模型决策下一个子智能体走向。</p>
<p>内置prompt：</p>
<p><img alt="image23" src="../_images/2025-11-19-00-02-18-image.png" /></p>
<p>具体示例代码：</p>
<p><img alt="image24" src="../_images/2025-11-19-00-02-38-image.png" /></p>
<p><img alt="image25" src="../_images/2025-11-19-00-02-51-image.png" /></p>
</div>
</div>
<div class="section" id="id10">
<h2>3.4 从单进程到分布式部署<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p><img alt="image26" src="../_images/2025-11-20-17-41-21-image.png" /></p>
<p>通过将Sub-Agent进行独立部署和维护，同时多个Sub-Agent间通过远程调用代替内存调用的方式，实现各个Sub-Agent独立迭代和维护。</p>
<div class="section" id="a2a">
<h3>3.4.1 什么是A2A协议<a class="headerlink" href="#a2a" title="Permalink to this headline">¶</a></h3>
<p>A2A协议，Agent2Agent，是Google在开源社区中推出的分布式智能体之间的统一通信协议。</p>
<p><strong>1、A2A协议中的角色</strong></p>
<ul class="simple">
<li><p>用户（User）</p></li>
<li><p>A2A客户端（Client Agent）</p></li>
<li><p>A2A服务端（Remote Agent）</p></li>
</ul>
<p><strong>2、A2A协议中的元素</strong></p>
<ul class="simple">
<li><p>智能体卡片（Agent Card）</p></li>
<li><p>任务（Task）</p></li>
<li><p>消息（Message）</p></li>
<li><p>产出物（Artifact）</p></li>
<li><p>内容块（Part）</p></li>
</ul>
<p><strong>3、A2A协议中的交互机制</strong></p>
<ul class="simple">
<li><p>轮询（Polling）</p></li>
<li><p>流式传输（Streaming）</p></li>
<li><p>推送通知（Push Notification）</p></li>
</ul>
</div>
<div class="section" id="id11">
<h3>3.4.2 A2A协议的工作流<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p><strong>1、发现A2A Server的AgentCard</strong></p>
<p><img alt="image27" src="../_images/2025-11-20-19-59-33-image.png" /></p>
<p><strong>2、A2A授权和权限认证</strong></p>
<p><img alt="image28" src="../_images/2025-11-20-20-00-22-image.png" /></p>
<p><strong>3、发起A2A请求</strong></p>
<p><strong>同步请求</strong></p>
<p><img alt="image29" src="../_images/2025-11-20-20-01-23-image.png" /></p>
<p><strong>流式请求</strong></p>
<p><img alt="image30" src="../_images/2025-11-20-20-01-38-image.png" /></p>
</div>
<div class="section" id="nacos-a2a-registry">
<h3>3.4.3 基于Nacos A2A Registry的自动注册与发现<a class="headerlink" href="#nacos-a2a-registry" title="Permalink to this headline">¶</a></h3>
<p>A2A工作流程的首个步骤就是进行远端Agent的AgentCard获取和发现。</p>
<p><strong>1、AgentCard的作用</strong></p>
<p>AgentCard是A2A
Server的数字名片，为发现与交互提供必要信息，包括以下内容：</p>
<ul class="simple">
<li><p>身份信息：名称、描述、服务提供方。</p></li>
<li><p>服务端点：远端Agent的访问URL，包含完整的域名/IP，端口，URI等。</p></li>
<li><p>协议能力：支持的协议功能（如流式传输streaming或推送通知pushNotifications）。</p></li>
<li><p>认证方式：交互所需的鉴权机制（如Bearer令牌、OAuth2）。</p></li>
<li><p>技能列表：智能体可执行的任务或功能（AgentSkill对象），含技能ID、名称、描述、输入/输出模式及示例。</p></li>
</ul>
<p>A2A
Client通过AgentCard判断远端Agent是否适配当前任务、如何构建请求以及安全通信方式。</p>
<p><strong>2、AgentCard的获取方式</strong></p>
<p><strong>直接配置</strong></p>
<p><img alt="image31" src="../_images/2025-11-20-20-15-40-image.png" /></p>
<p><strong>固定URI（Well-Known URI）</strong></p>
<p><img alt="image32" src="../_images/2025-11-20-20-16-26-image.png" /></p>
<p>另外还有第三种方式，注册中心。</p>
</div>
<div class="section" id="nacos-a2a">
<h3>3.4.4 Nacos A2A注册中心<a class="headerlink" href="#nacos-a2a" title="Permalink to this headline">¶</a></h3>
<p><img alt="image33" src="../_images/2025-11-21-17-42-12-image.png" /></p>
<p>由注册中心维护AgentCard集合，客户端通过查询条件（如技能、标签、提供方）检索目标。</p>
<p><img alt="image34" src="../_images/2025-11-21-17-43-55-image.png" /></p>
<p>Nacos还支持对Agent的版本进行管理和快速回滚。Nacos除了作为A2A注册中心，还可以作为MCP服务的注册中心，以及Prompt的动态管理中心。</p>
</div>
</div>
<div class="section" id="id12">
<h2>3.5 消息驱动的智能体开发模式<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>AI云原生架构下的消息队列必须具备以下特点：</p>
<ul class="simple">
<li><p>支持长会话与大消息体的消息中枢。</p></li>
<li><p>实现削峰填谷、定速消费的智能调度能力。</p></li>
<li><p>提供优先级、权重控制的分级事件驱动机制。</p></li>
<li><p>构建高可靠、可恢复的Agent编排引擎。</p></li>
</ul>
<div class="section" id="ai">
<h3>3.5.1 消息模型提升AI通信效率<a class="headerlink" href="#ai" title="Permalink to this headline">¶</a></h3>
<p>RocketMQ提出了一种创新的轻量化架构：</p>
<p><img alt="image35" src="../_images/2025-11-21-17-57-19-image.png" /></p>
<p>核心理念是：为每个会话或问题，动态创建一个独立的轻量级主题（Lite-Topic）。</p>
<p>以客户端与AI服务建立会话为例，系统自动创建一个以SessionID命名的专属队列，所有会话历史、上下文和中间结果均以消息形式在该主题中有序流转。</p>
<p>这一架构提供了四大核心能力：</p>
<ul class="simple">
<li><p>百万级Lite-Topic支持：单集群管理百万级Lite-Topic，每个会话独立Topic，高并发下会话隔离，性能无损。</p></li>
<li><p>全自动轻量管理：Lite-Topic按需动态创建，连接断开后自动回收。</p></li>
<li><p>大消息体传输能力：支持数十MB以上消息，可承载长Prompt、图像、文档等。</p></li>
<li><p>严格顺序消息保障：在单队列内保证消息有序，确保LLM流式输出的token顺序不乱。</p></li>
</ul>
<p><strong>轻量级发送</strong></p>
<p>Queue的消息是某个Broker专属的，一个Lite-Topic的发送只会到一台Broker，而不是轮询发送。</p>
<p><strong>轻量级订阅</strong></p>
<p>以client_ID维度维护订阅关系，管理消费进度。新增互斥消费模式。TTL到期后自动删除订阅关系。</p>
<p><strong>消息分发策略</strong></p>
<p><img alt="image36" src="../_images/2025-11-21-18-17-47-image.png" /></p>
<ul class="simple">
<li><p>客户端发起读请求不再指定Topic，而是Broker根据client_ID识别订阅关系，并返回多个Topic的多条消息。</p></li>
<li><p>引入Topic ready set，在POP请求处理时直接访问就绪的topic。</p></li>
<li><p>当订阅上线、新消息发送、消息ACK后仍有消息、order Lock释放时往Topic
ready set进行add操作。</p></li>
</ul>
</div>
<div class="section" id="id13">
<h3>3.5.2 基于消息驱动的智能化资源调度<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>核心能力：</p>
<ul class="simple">
<li><p>天然削峰填谷，保护AI算力：消息队列可缓存突发请求。</p></li>
<li><p>定速消费，精准控制算力使用：支持为消费者组设置消费配额。</p></li>
<li><p>优先级调度，实现智能资源分配：抢占式优先级，权重动态分配。</p></li>
</ul>
</div>
</div>
<div class="section" id="id14">
<h2>3.6 基于统一元数据的AI协同开发模式<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<p><img alt="image37" src="../_images/2025-11-21-18-41-51-image.png" /></p>
<p>AI时代，可以基于统一元数据，所有交付物都使用HTML格式，每个角色的产出可以直接被下游角色使用，并且在开发全流程的每个环节都基于AI提效。</p>
<p><img alt="image38" src="../_images/2025-11-21-18-44-54-image.png" /></p>
<p>统一元数据需要长期建设，包括设计系统、组件库、API规范、状态管理等。从建立需求即代码的团队协作基准开始，从组件契约标准化入手，逐步构建跨工具链的智能开发环境。</p>
<blockquote>
<div><p>参考资料：</p>
<p><a class="reference external" href="https://developer.aliyun.com/ebook/8479">https://developer.aliyun.com/ebook/8479</a></p>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="002004-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91%E4%B8%8A%E4%B8%8B%E6%96%87%E5%B7%A5%E7%A8%8B.html" class="btn btn-neutral float-right" title="【AI白皮书】上下文工程" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="002002-%E3%80%90AI%E7%99%BD%E7%9A%AE%E4%B9%A6%E3%80%91AI%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E7%9A%84%E5%85%B3%E9%94%AE%E8%A6%81%E7%B4%A0.html" class="btn btn-neutral float-left" title="【AI白皮书】AI原生应用的关键要素" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 测试开发Gang

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>